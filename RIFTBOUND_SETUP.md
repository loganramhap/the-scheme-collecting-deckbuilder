# Riftbound Card Support Setup

This document describes the Riftbound card support that has been added to the deckbuilder.

## Changes Made

### 1. Format Handling
- **Removed format selection for Riftbound** - Since Riftbound has only one format, the format dropdown is hidden when creating Riftbound decks
- Riftbound decks automatically use "standard" format internally
- Format is not displayed on Riftbound deck cards in the dashboard

### 2. Validation Rules
Created comprehensive validation in `deckbuilder-webapp/src/utils/deckValidation.ts`:

**Riftbound Deck Rules:**
- Exactly 40 cards (excluding legend, runes, and battlefields)
- Exactly 1 legend (required)
- Exactly 12 rune cards
- Exactly 3 battlefield cards
- Maximum 3 copies of any single card

**MTG Deck Rules:**
- Commander: 99 cards + 1 commander, max 1 copy of each card (except basic lands)
- Other formats: Minimum 60 cards

### 3. Card Data Structure
Updated `deckbuilder-webapp/src/types/card.ts` with proper Riftbound card interface:

```typescript
interface RiftboundCard {
  id: string;
  name: string;
  type: string; // unit, spell, rune, battlefield, legend
  subtype?: string;
  cost?: number;
  attack?: number;
  health?: number;
  rarity?: string;
  color?: string;
  text?: string;
  image_url?: string;
  // ... more fields
}
```

### 4. Card Loading Service
Created `deckbuilder-webapp/src/services/riftboundCards.ts` to:
- Load cards from `/data/riftbound-cards.json`
- Cache loaded cards
- Provide search and filter functions
- Extract unique types and colors

### 5. Scraping Scripts
Created scripts to help populate card data:
- `scripts/scrape-riftbound-puppeteer.js` - Automated scraping with Puppeteer
- `scripts/scrape-riftbound-cards.js` - Basic HTTP scraping
- `scripts/README-RIFTBOUND-SCRAPING.md` - Detailed instructions

## Next Steps

### 1. Populate Card Data

**Option A: Automated Download (Recommended)**
```bash
node scripts/download-google-sheet.js
```

This downloads card data from the community Google Sheet and automatically converts it to JSON.

**Option B: Manual CSV Download**
1. Open: https://docs.google.com/spreadsheets/d/1qzhPO27wyNwKvK2istAIPgkjvs67mSpdUTXM1Quwc8Y/edit?gid=590133021#gid=590133021
2. File > Download > Comma Separated Values (.csv)
3. Save as `data/riftbound-cards.csv`
4. Run: `node scripts/convert-google-sheet.js`

**Option C: Manual Entry**
Use the template in `data/riftbound-cards-template.json` as a guide.

See `scripts/README-RIFTBOUND-SCRAPING.md` for more details.

### 2. Update DeckEditor Component
The DeckEditor needs to be updated to:
- Load Riftbound cards using the new service
- Display Riftbound-specific UI (legend slot, rune counter, battlefield counter)
- Show validation errors from the new validation system

### 3. Test the Integration
1. Create a new Riftbound deck
2. Add cards and verify validation works
3. Check that the 40-card rule (excluding special cards) is enforced
4. Verify the 3-copy limit per card

## File Structure

```
deckbuilder-webapp/
├── public/
│   └── data/
│       └── riftbound-cards.json          # Card data (needs to be populated)
├── src/
│   ├── services/
│   │   └── riftboundCards.ts             # Card loading service
│   ├── types/
│   │   └── card.ts                       # Updated with RiftboundCard type
│   ├── utils/
│   │   └── deckValidation.ts             # Validation rules
│   ├── components/
│   │   └── deckbuilder/
│   │       └── DeckStatistics.tsx        # Updated to use validation
│   └── pages/
│       └── Dashboard.tsx                 # Updated format handling

scripts/
├── scrape-riftbound-puppeteer.js        # Puppeteer scraper
├── scrape-riftbound-cards.js            # Basic scraper
└── README-RIFTBOUND-SCRAPING.md         # Scraping instructions

data/
├── riftbound-cards-template.json        # Template for manual entry
└── riftbound-cards.json                 # Generated by scrapers
```

## Validation Examples

### Valid Riftbound Deck
- 40 regular cards
- 1 legend
- 12 runes
- 3 battlefields
- No card appears more than 3 times
- **Total: 56 cards**

### Invalid Examples
- 38 regular cards → Error: "Deck must have at least 40 cards"
- 0 legends → Error: "Riftbound decks must have a legend"
- 10 runes → Error: "Riftbound decks must have exactly 12 rune cards"
- 4 copies of "Fire Bolt" → Error: "Fire Bolt appears 4 times (Riftbound allows maximum 3 copies)"

## Integration with Existing Code

The validation system integrates with:
- `DeckStatistics` component - Shows validation errors/warnings
- `Dashboard` - Hides format selection for Riftbound
- Future: `DeckEditor` - Will use validation for real-time feedback
